<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Volume Application — Step by Step Procedure</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root{
  --bg:#f4f7fb;
  --card:#ffffff;
  --muted:#64748b;
  --accent:#4d148c;
  --accent-dark:#3a0f6b;
  --orange:#ff6600;
  font-family: Inter, ui-sans-serif, system-ui;
}

*{box-sizing:border-box;}
body{
  margin:0;
  background:linear-gradient(180deg,var(--bg),#eef6ff);
  display:flex;
  flex-direction:column;
  min-height:100vh;
}

/* ---------- HEADER ---------- */
header{
  background:var(--accent);
  color:white;
  padding:16px 28px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  position:relative;
  overflow:hidden;
}

header img{height:40px;}

.nav-tabs{display:flex; gap:30px;}
.tab{
  color:white;
  text-decoration:none;
  font-weight:600;
  font-size:16px;
  position:relative;
  padding:6px 0;
}
.tab.active::after{
  content:"";
  position:absolute;
  left:0;
  bottom:-6px;
  width:100%;
  height:3px;
  background:var(--orange);
  border-radius:3px;
}

/* ---------- BANNER ---------- */
.welcome-section{
  background: linear-gradient(90deg,#4D148C 0%,#330d5e 50%,#FF6600 100%);
  background-size:200% 200%;
  animation: shimmer 15s ease infinite;
  color:white;
  padding:20px 40px;
}

@keyframes shimmer{
  0%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
  100%{background-position:0% 50%;}
}

.welcome-content h1{
  margin:0;
  font-size:2rem;
  font-weight:800;
}

.welcome-content p{
  margin-top:6px;
  opacity:0.9;
}

/* ---------- MAIN CARD ---------- */
.main{
  flex:1;
  display:flex;
  justify-content:center;
  padding:40px;
}

.step-card{
  background:white;
  width:100%;
  max-width:900px;
  padding:40px;
  border-radius:16px;
  box-shadow:0 15px 40px rgba(0,0,0,0.08);
  position:relative;
  overflow:hidden;
}

.step-counter{
  font-size:14px;
  font-weight:600;
  color:var(--muted);
  margin-bottom:15px;
}

.step-title{
  font-size:22px;
  font-weight:700;
  margin-bottom:20px;
  color:var(--accent-dark);
}

.step-content{
  font-size:16px;
  line-height:1.6;
  white-space:pre-line;
  margin-bottom:30px;
}

/* Progress Bar */
.progress-container{
  height:6px;
  background:#e5e7eb;
  border-radius:10px;
  overflow:hidden;
  margin-bottom:30px;
}

.progress-bar{
  height:100%;
  background:linear-gradient(90deg,var(--accent),var(--orange));
  width:0%;
  transition:width 0.4s ease;
}

/* Navigation */
.nav-buttons{
  display:flex;
  justify-content:space-between;
}

button{
  padding:12px 24px;
  border:none;
  border-radius:8px;
  font-weight:600;
  cursor:pointer;
  transition:all 0.2s ease;
}

.btn-prev{
  background:#e5e7eb;
}

.btn-next{
  background:var(--accent);
  color:white;
}

.btn-next:hover{
  background:var(--accent-dark);
}

button:disabled{
  opacity:0.5;
  cursor:not-allowed;
}

/* Fade animation */
.fade{
  animation:fadeIn 0.3s ease;
}

@keyframes fadeIn{
  from{opacity:0; transform:translateX(10px);}
  to{opacity:1; transform:translateX(0);}
}

footer{
  background:var(--accent);
  color:white;
  text-align:center;
  padding:16px;
}

/* =========================
   PROFESSIONAL MODALS
========================= */
/* MODALS */
.modal {
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.4);
  justify-content:center;
  align-items:center;
  padding:20px;
  z-index:1000;
}
.modal-content {
  background:white;
  border-radius:10px;
  padding:24px;
  width:100%;
  max-width:500px;
  box-shadow:0 10px 30px rgba(0,0,0,0.2);
}
.modal-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:20px;
  font-weight:700;
  margin-bottom:12px;
}
.modal-close {
  font-size:22px;
  cursor:pointer;
  color:var(--muted);
}
.modal-close:hover {color:var(--accent);}

/* STAR RATING */
.rating-container{display:flex;justify-content:center;gap:10px;margin-top:12px;}
.rating-star{cursor:pointer;font-size:28px;color:#ccc;transition:color .2s,transform .2s;}
.rating-star:hover{transform:scale(1.3);}
.rating-star.selected{color:var(--accent-dark);}

/* COMMENTS */
.comment-list-item{padding:12px 0;border-bottom:1px solid #eee;}
.comment-list-item .stars{color:var(--accent-dark);font-size:18px;margin-bottom:6px;}
.comment-list-item:last-child{border:none;}
input,textarea{width:100%;padding:8px;margin-top:10px;border:1px solid #ccc;border-radius:6px;font-size:14px;}
textarea{resize:none;min-height:80px;}

/* TIME CALENDAR */
#timeCalendarPopup {
  display:none;
  position:absolute;
  top:60px; right:20px;
  background:white;
  border-radius:8px;
  box-shadow:0 8px 24px rgba(0,0,0,0.25);
  padding:16px;
  width:310px;
  z-index:900;
}
#timeCalendarPopup h3 {
  margin:0;text-align:center;font-size:18px;color:var(--accent-dark);
  margin-bottom:8px;
}
.calendar-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#f0f0f0;
  padding:8px;
  border-radius:6px;
}
.calendar-header span{cursor:pointer;color:var(--accent-dark);font-weight:600;}
.calendar-title{font-weight:700;}
.calendar-grid{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:4px;
  margin-top:8px;
}
.calendar-grid .day-name{text-align:center;font-size:12px;font-weight:700;color:var(--muted);}
.calendar-grid .day{text-align:center;padding:8px 0;font-size:14px;border-radius:50%;}
.calendar-grid .today{background:var(--accent);color:white;font-weight:700;}
.calendar-grid .day:hover{background:#f0f0f0;}

/* COMMENT LINK */
.link-text{
  color:var(--accent-dark);
  cursor:pointer;
  text-decoration:underline;
  font-size:14px;
  margin-top:10px;
  display:block;
}

/* STAR RATING COLORS */
.rating-container {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-top: 12px;
}

.rating-star {
  cursor: pointer;
  font-size: 28px;
  color: #ccc; /* default grey */
  transition: color .2s, transform .2s;
}

.rating-star:hover {
  transform: scale(1.3);
}

.rating-star.selected {
  color: #FF6600; /* FedEx orange */
}

/* footer alignment */
.comment-modal-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 12px;
}

.link-text {
  color: var(--accent-dark);
  cursor: pointer;
  text-decoration: underline;
  font-size: 14px;
}

/* COMMENT LIST STAR COLORS */
#commentsList .stars {
  color: #FF6600; /* FedEx orange */
  font-size: 18px;
  margin-bottom: 6px;
  display: block;
}

/* ---------- HEADER ---------- */
header{
  background:var(--accent);
  color:white;
  padding:16px 28px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  position:relative;
  overflow:hidden;
  z-index:1;
}
header img{height:40px; animation:logoFlyIn 1s ease-out forwards; opacity:0;}
.nav-tabs{display:flex; gap:30px;}
.tab{color:white; text-decoration:none; font-weight:600; font-size:16px; position:relative; padding:6px 0; transition: opacity 0.2s;}
.tab:hover{opacity:0.8;}
.tab.active::after{content:"";position:absolute;left:0;bottom:-6px;width:100%;height:3px;background:#ff6600;border-radius:3px;}

.header-icons{display:flex;align-items:center;gap:20px;}
#clockBtn{cursor:pointer; display:flex; align-items:center; gap:6px; font-size:18px; font-weight:600; color:white; position:relative;}
#clockBtn:hover{transform:scale(1.1);}
.header-icon{font-size:24px;color:white;cursor:pointer;transition:color .2s,transform .2s;}
.header-icon:hover{transform:scale(1.3);}
.header-icon.active{color:var(--accent-dark);}

/* ---------- HEADER ANIMATIONS ---------- */
@keyframes logoFlyIn {0%{opacity:0;transform:translateX(-50px) scale(0.8);}100%{opacity:1;transform:translateX(0) scale(1);}}
header::after{
  content:"";
  position:absolute; top:0; left:-100%;
  width:100%; height:100%;
  background: linear-gradient(120deg, #4d148c, #ff6600, #4d148c);
  transform:skewX(-20deg);
  animation:sweep 1s ease-out forwards;
  z-index:0;
  opacity:0.2;
}
@keyframes sweep{0%{left:-100%;}100%{left:100%;}}

.message-box{
  background: var(--card);
  width:100%;
  max-width:1100px;
  border-radius:16px;
  box-shadow:0 15px 40px rgba(0,0,0,0.08);
  overflow:hidden;
}
/* ---------- FED-EX ORANGE & PURPLE BANNER ---------- */
.welcome-section {
  background: linear-gradient(90deg, #4D148C 0%, #330d5e 50%, #FF6600 100%);
  background-size: 200% 200%;
  animation: fedexShimmer 15s ease infinite; /* slow shimmer */
  color: white;
  padding: 15px 30px;   /* compact height */
  text-align: left;     /* left-aligned text */
  margin-bottom: 20px;
  box-shadow: 0 5px 15px rgba(77, 20, 140, 0.15); /* subtle shadow */
  border-radius: 0;     /* straight edges */
}

/* Shimmer animation */
@keyframes fedexShimmer {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

.welcome-content h1 {
  font-size: 2rem;  /* compact heading */
  margin-bottom: 6px;
  font-weight: 800;
  letter-spacing: -0.5px;
}

.welcome-content p {
  font-size: 1rem;  /* smaller subtitle */
  max-width: 600px;
  margin: 0;
  opacity: 0.9;
  line-height: 1.5;
}
/* ---------- MAIN ---------- */
.main{
  flex:1;
  padding:40px;
  display:flex;
  justify-content:center;
}
.message-box{
  background:white;
  padding:40px;
  border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,0.08);
  width:100%;
  max-width:1800px; /* match main menu shell */
}

.btn{
  background:var(--accent);
  color:white;
  border:none;
  padding:10px 18px;
  border-radius:8px;
  cursor:pointer;
  font-weight:600;
}
.btn:hover{background:var(--accent-dark);}

/* ---------- VOLUME STEP BACKGROUND ---------- */
.volume-content-wrapper{
  background:#f1f5f9; /* same soft grey used in directory table */
  border-radius:12px;
  padding:30px;
  margin-top:30px;
  margin-bottom:30px;
}

</style>
</head>
<body>

<header>
  <div style="display:flex;align-items:center;gap:40px;">
    <a href="index.html">
      <img src="fedex.png" alt="FedEx Logo">
    </a>
    <nav class="nav-tabs">
      <a href="index.html" class="tab">Home</a>
      <a href="case-directory.html" class="tab">Case Directory</a>
      <a href="ebs-response-template.html" class="tab">EBS Response</a>
      <a href="volume-application.html" class="tab active">Volume Application</a>  
    </nav>
  </div>
  
    <div class="header-icons">
    <div id="clockBtn">
      <i class="fa-regular fa-clock"></i>
      <span id="clockText">--:-- PM</span>
    </div>
    <i class="header-icon fa-solid fa-comment-dots" id="commentIcon" title="Feedback"></i>
    <i class="header-icon fa-solid fa-circle-question" id="helpIcon" title="Get Help"></i>
  </div>
  
</header>


<div class="main">
  <div class="message-box">

    <div class="welcome-section">
      <div class="welcome-content">
        <h1>Volume Application — Step by Step Procedure</h1>
        <p>Follow the guided steps to correctly apply a Volume Quote.</p>
      </div>
    </div>

    <div class="volume-content-wrapper">

  <div class="step-counter" id="stepCounter"></div>

  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <div class="step-title" id="stepTitle"></div>
  <div class="step-content" id="stepContent"></div>

  <div class="nav-buttons">
    <button class="btn-prev" id="prevBtn">Previous</button>
    <button class="btn-next" id="nextBtn">Next</button>
  </div>

</div>

  </div>
</div>

<footer>© 2025 EBS Operations</footer>
<!-- HELP MODAL -->
<div id="helpModal" class="modal">
  <div class="modal-content" onclick="event.stopPropagation()">
    <div class="modal-header">
      Get Help <span class="modal-close" onclick="closeHelp()">×</span>
    </div>
    <p>Use this tool to search queues, concerns, and actions. Click the clock for time/calendar and the comment icon to provide feedback.</p>
  </div>
</div>

<!-- COMMENT MODALS -->
<div id="commentModal" class="modal">
  <div class="modal-content" onclick="event.stopPropagation()">
    <div class="modal-header">
      How do you rate the tool? <span class="modal-close" onclick="closeComment()">×</span>
    </div>
    <div class="rating-container">
      <i class="fa-solid fa-star rating-star" data-value="1"></i>
      <i class="fa-solid fa-star rating-star" data-value="2"></i>
      <i class="fa-solid fa-star rating-star" data-value="3"></i>
      <i class="fa-solid fa-star rating-star" data-value="4"></i>
      <i class="fa-solid fa-star rating-star" data-value="5"></i>
    </div>
    <input type="text" id="commentName" placeholder="Your Name (optional)">
    <textarea id="commentText" placeholder="Enter your comment..."></textarea>
    <div class="comment-modal-footer">
      <button class="btn" onclick="sendComment()">Send</button>
      <span class="link-text" onclick="showAllComments()">View all comments & ratings</span>
    </div>
  </div>
</div>

<div id="allCommentsModal" class="modal">
  <div class="modal-content" onclick="event.stopPropagation()">
    <div class="modal-header">
      All Ratings & Comments <span class="modal-close" onclick="closeAllComments()">×</span>
    </div>
    <div id="commentsList"></div>
  </div>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<!-- TIME & CALENDAR POPUP -->
<div id="timeCalendarPopup">
  <h3 id="calendarTitle"></h3>

  <div class="calendar-header">
    <span id="prevMonth">◀</span>
    <span class="calendar-title" id="monthYear"></span>
    <span id="nextMonth">▶</span>
  </div>

  <div class="calendar-grid" id="calendarGrid"></div>
</div>

<script>
const steps = [
{
title:"Adjust Freight Charges",
content:`On the freight charges line, change the rate line to FLAT and apply the volume quote amount in the charge line.`
},
{
title:"Remove Rate Keywords",
content:`• Remove all rate keywords (FSCL, DEWT, RAZ, LEDI, PRAU, BRAP)
• Capacity load keywords do NOT need to be removed.
• Add RMK line stating: "CAPL NOT APPLICABLE PER TRUCKLOAD."`
},
{
title:"Zero Out Surcharges",
content:`Zero out any of the following surcharges:
• VICH
• VWCH
• OVRL
• Extreme Length
• High Cost
• California Compliance Fee
• Demand Surcharge`
},
{
title:"Validate Additional Surcharges",
content:`• Check COMMENTS / ADDITIONAL SERVICES dropdown.
• If surcharges with checkmarks are the only ones included in the quote, remove surcharge on FBC.
• No checkmark = not included in quote.`
},
{
title:"Add CONT Keyword",
content:`• Add keyword "CONT".
• Add full quote number into "CONT Number" field.
• If error appears, click OK.
• If "CM Option" dropdown appears, select service option noted on BOL (TLX, TLS, EXCL).
• If none is noted, choose TLX. Click OK.`
},
{
title:"System Auto Adds Keywords",
content:`System will automatically add:
• CONT
• TLX

Below this point, add:
• SLCU
• NOAR`
},
{
title:"Add PRAU & Agreement Details",
content:`• Below NOAR, add keyword PRAU.
• In Agreement Type dropdown, choose "CONT".
• In Tariff dropdown, choose service type from BOL (TLX, TLS, EXCL).
• Enter 7 numbers between F and CM in quote number.
• In Base Type dropdown, select "CUST".
• In AP1 dropdown, select who the pro is billed to.
• Click OK when finished.`
},
{
title:"Clean Description Field",
content:`Delete all blank lines in the description field.`
},
{
title:"Add Correction Code",
content:`Add correction code based on reason:

EADL – Volume quote listed on BOL but biller did not bill.
SYSM – Volume quote noted but automation didn’t recognize it.
CMID – Shipper/consignee/BT did not provide volume quote on BOL.`
},
{
title:"Final Step",
content:`At last, click ACCEPT ALL.`
}
];

let currentStep = 0;

const stepTitle = document.getElementById("stepTitle");
const stepContent = document.getElementById("stepContent");
const stepCounter = document.getElementById("stepCounter");
const progressBar = document.getElementById("progressBar");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");

function renderStep(){
  const step = steps[currentStep];

  stepTitle.textContent = step.title;
  stepContent.textContent = step.content;
  stepCounter.textContent = `Step ${currentStep + 1} of ${steps.length}`;
  progressBar.style.width = ((currentStep+1)/steps.length*100)+"%";

  prevBtn.disabled = currentStep === 0;
  nextBtn.textContent = currentStep === steps.length - 1 ? "Finish" : "Next";
}

prevBtn.onclick = () => {
  if(currentStep > 0){
    currentStep--;
    renderStep();
  }
};

nextBtn.onclick = () => {
  if(currentStep < steps.length - 1){
    currentStep++;
    renderStep();
  } else {
    alert("Volume Application Completed.");
  }
};

renderStep();


/* =========================
   CALENDAR LOGIC
========================= */
function getPHTime(){
  const now = new Date();
  return new Date(now.toLocaleString("en-US", { timeZone: "Asia/Manila" }));
}

function updateClock(){
  const now = getPHTime();
  const timeStr = now.toLocaleTimeString("en-PH", {
    hour: "2-digit",
    minute: "2-digit"
  });
  document.getElementById("clockText").textContent = timeStr;
}

setInterval(updateClock, 1000);
updateClock();

const clockBtn = document.getElementById("clockBtn");
const calendarPopup = document.getElementById("timeCalendarPopup");
const calendarGrid = document.getElementById("calendarGrid");
const monthYear = document.getElementById("monthYear");

let currentDate = getPHTime();

clockBtn.onclick = function(e){
  e.stopPropagation();
  calendarPopup.style.display =
    calendarPopup.style.display === "block" ? "none" : "block";
  renderCalendar(currentDate);
};

document.addEventListener("click", function(){
  calendarPopup.style.display = "none";
});

document.getElementById("prevMonth").onclick = function(e){
  e.stopPropagation();
  currentDate.setMonth(currentDate.getMonth() - 1);
  renderCalendar(currentDate);
};

document.getElementById("nextMonth").onclick = function(e){
  e.stopPropagation();
  currentDate.setMonth(currentDate.getMonth() + 1);
  renderCalendar(currentDate);
};

function renderCalendar(date){
  calendarGrid.innerHTML = "";

  const year = date.getFullYear();
  const month = date.getMonth();

  const firstDay = new Date(year, month, 1).getDay();
  const daysInMonth = new Date(year, month + 1, 0).getDate();

  monthYear.textContent =
    date.toLocaleString("en-PH", { month: "long", year: "numeric" });

  const dayNames = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
  dayNames.forEach(d=>{
    const el = document.createElement("div");
    el.className="day-name";
    el.textContent=d;
    calendarGrid.appendChild(el);
  });

  for(let i=0;i<firstDay;i++){
    const empty=document.createElement("div");
    calendarGrid.appendChild(empty);
  }

  const today = getPHTime();

  for(let d=1; d<=daysInMonth; d++){
    const day=document.createElement("div");
    day.className="day";
    day.textContent=d;

    if(
      d===today.getDate() &&
      month===today.getMonth() &&
      year===today.getFullYear()
    ){
      day.classList.add("today");
    }

    calendarGrid.appendChild(day);
  }
}
/* =========================
   MODALS
========================= */

document.getElementById("helpIcon").onclick = () =>
  document.getElementById("helpModal").style.display = "flex";

document.getElementById("commentIcon").onclick = () => {
  clearCommentForm();
  document.getElementById("commentModal").style.display = "flex";
};

function closeHelp(){document.getElementById("helpModal").style.display="none";}
function closeComment(){document.getElementById("commentModal").style.display="none";}
function closeAllComments(){document.getElementById("allCommentsModal").style.display="none";}


/* =========================
   FEEDBACK SYSTEM
========================= */

let selectedRating = 0;

document.querySelectorAll('.rating-star').forEach(star=>{
  star.onclick=function(){
    selectedRating=parseInt(this.dataset.value);
    document.querySelectorAll('.rating-star').forEach(s=>
      s.classList.toggle('selected', parseInt(s.dataset.value)<=selectedRating)
    );
  };
});


function sendComment(){
  const name = document.getElementById('commentName').value.trim();
  const comment = document.getElementById('commentText').value.trim();

  if(selectedRating===0){
    alert("Select a rating.");
    return;
  }

  db.collection("feedback").add({
    rating:selectedRating,
    name:name||"Anonymous",
    comment:comment,
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  }).then(()=>{
    alert("Saved!");
    clearCommentForm();
  }).catch(()=>alert("Save failed."));
}


function clearCommentForm(){
  selectedRating=0;
  document.getElementById('commentName').value="";
  document.getElementById('commentText').value="";
  document.querySelectorAll('.rating-star').forEach(s=>s.classList.remove('selected'));
}


let unsubscribeListener=null;

function showAllComments(){
  const listEl=document.getElementById('commentsList');
  listEl.innerHTML="Loading…";

  if(unsubscribeListener) unsubscribeListener();

  unsubscribeListener=db.collection("feedback")
    .orderBy("createdAt","desc")
    .onSnapshot(snap=>{
      listEl.innerHTML="";
      if(snap.empty){
        listEl.innerHTML="<p>No feedback yet.</p>";
      }
      snap.forEach(doc=>{
        const d=doc.data();
        const div=document.createElement('div');
        div.className="comment-list-item";
        div.innerHTML=`
          <div class="stars">${"★".repeat(d.rating)}${"☆".repeat(5-d.rating)}</div>
          <strong>${d.name}</strong>
          <p>${d.comment}</p>
        `;
        listEl.appendChild(div);
      });
      document.getElementById('allCommentsModal').style.display='flex';
    });
}

</script>

</body>
</html>
