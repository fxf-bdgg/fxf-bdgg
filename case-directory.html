<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>BD Tools — Case Directory</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

<style>
:root{
  --bg:#f4f7fb;
  --card:#ffffff;
  --muted:#64748b;
  --accent:#4d148c;
  --accent-dark:#3a0f6b;
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  color:#0f172a;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:linear-gradient(180deg,var(--bg),#eef6ff);
  display:flex;
  flex-direction:column;
  min-height:100vh;
}

/* HEADER + NAV */
header, footer{
  background:var(--accent);
  color:white;
  padding:16px 28px;
}
header{display:flex;align-items:center;justify-content:space-between; position:relative; overflow:hidden; z-index:1;}
.header-icons{display:flex;align-items:center;gap:20px;}
#clockBtn{cursor:pointer;display:flex;align-items:center;gap:6px;font-size:18px;font-weight:600;color:white;}
#clockBtn:hover{transform:scale(1.1);}
.header-icon{font-size:24px;color:white;cursor:pointer;transition:color .2s,transform .2s;}
.header-icon:hover{transform:scale(1.3);}
.nav-tabs{display:flex;gap:30px;}
.tab{color:white;text-decoration:none;font-weight:600;font-size:16px;position:relative;padding:6px 0;transition:opacity .2s;}
.tab:hover{opacity:.8;}
.tab.active::after{content:"";position:absolute;left:0;bottom:-6px;width:100%;height:3px;background:#ff6600;border-radius:3px;}

@keyframes logoFlyIn{0%{opacity:0;transform:translateX(-50px) scale(.8);}100%{opacity:1;transform:none;}}
header img{opacity:0;animation:logoFlyIn 1s ease-out forwards;}

header::after{
  content:"";position:absolute;top:0;left:-100%;
  width:100%;height:100%;
  background:linear-gradient(120deg,#4d148c,#ff6600,#4d148c);
  transform:skewX(-20deg);animation:sweep 1s ease-out forwards;opacity:.2;z-index:0;
}
@keyframes sweep{to{left:100%;}}

/* MAIN SHELL */
.main{
  flex:1;
  padding:32px 24px;
  display:flex;
  justify-content:center;
}
.shell{
  width:100%;
  max-width:1400px;
}
.card{
  background:var(--card);
  border-radius:12px;
  padding:20px 22px;
  box-shadow:0 8px 28px rgba(2,6,23,.06);
}

/* PAGE TITLE */
.page-title{color:var(--accent);font-size:28px;font-weight:800;margin:0 0 6px;}
.page-subtitle{color:var(--muted);margin:0 0 14px;}

/* SEARCH */
input{
  width:100%;
  padding:14px 16px;
  border-radius:10px;
  border:1px solid #e2e8f0;
  font-size:15px;
  margin:18px 0 18px;
  outline:none;
}
input:focus{border-color:var(--accent);box-shadow:0 0 0 2px rgba(77,20,140,.15);}

/* TABLE */
.table-wrap{
  max-height:65vh;
  overflow:auto;
  border:1px solid #eef2f7;
  border-radius:12px;
}
table{width:100%;border-collapse:separate;border-spacing:0;font-size:14px;}
thead th{
  position:sticky;top:0;z-index:2;
  background:#f1f5f9;
  text-align:left;font-weight:700;color:#334155;
  border-bottom:2px solid #e2e8f0;
  padding:14px 12px;
}
td{padding:14px 12px;vertical-align:top;}
tbody tr:hover{background:#f8fafc;}
tbody td:first-child{font-weight:700;}
pre{background:#f8fafc;padding:10px;border-radius:6px;white-space:pre-wrap;margin:0;}
mark{background:#ffedd5;padding:0 3px;border-radius:4px;}

/* MODALS + CALENDAR (same as main) */
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.4);justify-content:center;align-items:center;padding:20px;z-index:1000;}
.modal-content{background:white;border-radius:10px;padding:24px;width:100%;max-width:500px;box-shadow:0 10px 30px rgba(0,0,0,.2);}
.modal-header{display:flex;justify-content:space-between;align-items:center;font-size:20px;font-weight:700;margin-bottom:12px;}
.modal-close{font-size:22px;cursor:pointer;color:var(--muted);}
.modal-close:hover{color:var(--accent);}

#timeCalendarPopup{display:none;position:absolute;top:60px;right:20px;background:white;border-radius:8px;box-shadow:0 8px 24px rgba(0,0,0,.25);padding:16px;width:310px;z-index:900;}
.calendar-header{display:flex;justify-content:space-between;align-items:center;background:#f0f0f0;padding:8px;border-radius:6px;}
.calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-top:8px;}
.calendar-grid .day-name{text-align:center;font-size:12px;font-weight:700;color:var(--muted);}
.calendar-grid .day{text-align:center;padding:8px 0;font-size:14px;border-radius:50%;}
.calendar-grid .today{background:var(--accent);color:white;font-weight:700;}

footer{text-align:center}
</style>
</head>

<body>

<header>
  <div style="display:flex;align-items:center;gap:40px;">
    <a href="index.html"><img src="fedex.png" alt="FedEx Logo" style="height:40px;"></a>
    <nav class="nav-tabs">
      <a href="index.html" class="tab">Home</a>
      <a href="case-directory.html" class="tab active">Case Directory</a>
      <a href="ebs-response-template.html" class="tab">EBS Response</a>
    </nav>
  </div>
  <div class="header-icons">
    <div id="clockBtn"><i class="fa-regular fa-clock"></i><span id="clockText">--:-- PM</span></div>
    <i class="header-icon fa-solid fa-comment-dots" id="commentIcon"></i>
    <i class="header-icon fa-solid fa-circle-question" id="helpIcon"></i>
  </div>
</header>

<div id="timeCalendarPopup">
  <h3 id="fullTimeDisplay">--:--:-- — --/--/----</h3>
  <div class="calendar-header">
    <span id="prevMonth">&lt;</span>
    <span id="monthYear"></span>
    <span id="nextMonth">&gt;</span>
  </div>
  <div class="calendar-grid" id="calendarGrid"></div>
</div>

<div class="main">
  <div class="shell">
    <div class="card">
      <h1 class="page-title">Case Directory</h1>
      <p class="page-subtitle">Search for the correct department or queue to move the case.</p>

      <input id="searchBox" placeholder="Search queue, concern, action, email, assignment...">

      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>QUEUE / Request</th>
              <th>Concern</th>
              <th>Action</th>
              <th>Email Address</th>
              <th>Case Assignment / Email</th>
            </tr>
          </thead>
          <tbody id="rows"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<footer>© 2025 EBS Operations</footer>

<script>
function getPhilippineNow(){
  return new Date(new Date().toLocaleString("en-PH",{timeZone:"Asia/Manila"}));
}
function updateHeaderClock(){
  const now=getPhilippineNow();
  clockText.textContent=now.toLocaleTimeString('en-PH',{hour:'2-digit',minute:'2-digit',hour12:true});
  fullTimeDisplay.textContent=now.toLocaleString('en-PH',{hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:true,month:'short',day:'numeric',year:'numeric'});
}
setInterval(updateHeaderClock,1000);updateHeaderClock();

let currentMonth=getPhilippineNow().getMonth(),currentYear=getPhilippineNow().getFullYear();
const monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];
function renderCalendar(y,m){
  calendarGrid.innerHTML="";
  monthYear.textContent=`${monthNames[m]} ${y}`;
  ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].forEach(d=>calendarGrid.innerHTML+=`<div class="day-name">${d}</div>`);
  const first=new Date(y,m,1).getDay(),days=new Date(y,m+1,0).getDate(),today=getPhilippineNow();
  for(let i=0;i<first;i++)calendarGrid.innerHTML+=`<div></div>`;
  for(let d=1;d<=days;d++){
    const cls=d===today.getDate()&&m===today.getMonth()&&y===today.getFullYear()?"day today":"day";
    calendarGrid.innerHTML+=`<div class="${cls}">${d}</div>`;
  }
}
clockBtn.onclick=e=>{timeCalendarPopup.style.display=timeCalendarPopup.style.display==='block'?'none':'block';renderCalendar(currentYear,currentMonth);e.stopPropagation();}
document.addEventListener('click',e=>{if(timeCalendarPopup.style.display==='block'&&!timeCalendarPopup.contains(e.target)&&!clockBtn.contains(e.target))timeCalendarPopup.style.display='none';});

function renderTable(rows,q=""){
  const re=q?new RegExp(`(${q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&')})`,"gi"):null;
  rowsEl.innerHTML=rows.map(r=>`
    <tr>
      <td>${re?(r['QUEUE/ Request']||"").replace(re,'<mark>$1</mark>'):r['QUEUE/ Request']||""}</td>
      <td>${r['Concern']||""}</td>
      <td>${r['ACTION']||""}</td>
      <td>${r['Email Address']||""}</td>
      <td><pre>${r['Case Assignment/Email']||""}</pre></td>
    </tr>
  `).join("");
}
Papa.parse("case-directory.csv",{download:true,header:true,skipEmptyLines:true,complete:r=>{
  window.CASES=r.data;
  renderTable(CASES);
  searchBox.oninput=e=>{
    const q=e.target.value.toLowerCase().trim();
    if(!q)return renderTable(CASES);
    const a=[],b=[],c=[];
    CASES.forEach(r=>{
      const qv=(r['QUEUE/ Request']||"").toLowerCase();
      const hit=[r['Concern'],r['ACTION'],r['Email Address'],r['Case Assignment/Email']].join(" ").toLowerCase();
      if(qv.startsWith(q))a.push(r);
      else if(qv.includes(q))b.push(r);
      else if(hit.includes(q))c.push(r);
    });
    renderTable([...a,...b,...c],q);
  }
}});
</script>

</body>
</html>
